---
layout: post
title: Sybase 1608 错误
category : Database
tags : [Database, SQLServer]
---

表现
====

SYBASE.log中有1608错误. 1608是客户端在服务器端不明真相的情况下异常断开.如果是偶尔有1608, 则不必担心, 这有可能是客户端的网络断了, 也可能是客户端被kill掉了. 是正常现象, 比如我们kill掉了 `isql`. 但如果频繁出现1608, 则是业务程序的问题. 我遇到过的是业务程序的查询时间超时然后 db 连接被 markdead, 接着连接断开.

如何找到是哪个程序
====

日志里有hostname的话,那就是该host导致的1608错误.

日志里没有hostname的话就使用以下语句来帮助定位是哪个IP, 按连接时间来排序,找到其IP, 通常断开再重连的客户端的登录时间会迟于其它客户端.

    SELECT ipaddr,hostname,loggedindatetime FROM master..sysprocesses ORDER BY loggedindatetime DESC

如果应用程序有 `SQL` 日志的话, 则能根据时间找到出问题的 `SQL` 语句.

可能能通过 Sybase ASE 的 Monitoring and Diagnostic (MDA) 表 或 SQLServer 的 Dynamic Management Views (DMV) 表 找出有问题的语句.